use crate::anemoi_jive::AnemoiJive;
use noah_algebra::bls12_381::BLSScalar;
use noah_algebra::new_bls12_381_fr;
use noah_algebra::prelude::*;

use super::N_ANEMOI_ROUNDS;

/// The structure that stores the parameters for the Anemoi-Jive hash function for BLS12-381.
pub struct AnemoiJive381;

impl AnemoiJive<BLSScalar, 2usize, N_ANEMOI_ROUNDS> for AnemoiJive381 {
    const ALPHA: u32 = 5u32;
    const GENERATOR: BLSScalar = new_bls12_381_fr!("7");
    const GENERATOR_INV: BLSScalar = new_bls12_381_fr!(
        "14981678621464625851270783002338847382197300714436467949315331057125308909861"
    );
    const GENERATOR_SQUARE_PLUS_ONE: BLSScalar = new_bls12_381_fr!("50");
    const ROUND_KEYS_X: [[BLSScalar; 2usize]; N_ANEMOI_ROUNDS] = [
        [
            new_bls12_381_fr!("39"),
            new_bls12_381_fr!(
                "17756515227822460609684409997111995494590448775258437999344446424780281143353"
            ),
        ],
        [
            new_bls12_381_fr!(
                "41362478282768062297187132445775312675360473883834860695283235286481594490621"
            ),
            new_bls12_381_fr!(
                "3384073892082712848969991795331397937188893616190315628722966662742467187281"
            ),
        ],
        [
            new_bls12_381_fr!(
                "9548818195234740988996233204400874453525674173109474205108603996010297049928"
            ),
            new_bls12_381_fr!(
                "51311880822158488881090781617710146800056386303122657365679608608648067582435"
            ),
        ],
        [
            new_bls12_381_fr!(
                "25365440569177822667580105183435418073995888230868180942004497015015045856900"
            ),
            new_bls12_381_fr!(
                "29347609441914902330741511702270026847909178228078752565372729158237774700914"
            ),
        ],
        [
            new_bls12_381_fr!(
                "34023498397393406644117994167986720327178154686105264833093891093045919619309"
            ),
            new_bls12_381_fr!(
                "2339620320400167830454536231899316133967303509954474267430948538955691907104"
            ),
        ],
        [
            new_bls12_381_fr!(
                "38816051319719761886041858113129205506758421478656182868737326994635468402951"
            ),
            new_bls12_381_fr!(
                "27338042530319738113354246208426108832239651080023276643867223794985578055610"
            ),
        ],
        [
            new_bls12_381_fr!(
                "35167418087531820804128377095512663922179887277669504047069913414630376083753"
            ),
            new_bls12_381_fr!(
                "42192983528513372869128514327443204912824559545179630597589572656156258515752"
            ),
        ],
        [
            new_bls12_381_fr!(
                "25885868839756469722325652387535232478219821850603640827385444642154834700231"
            ),
            new_bls12_381_fr!(
                "42721818980548514490325424436763032046927347769153393863616095871384405840432"
            ),
        ],
        [
            new_bls12_381_fr!(
                "8867588811641202981080659274007552529205713737251862066053445622305818871963"
            ),
            new_bls12_381_fr!(
                "23473499332437056484066006746048591864129988909190267521144125882222313735740"
            ),
        ],
        [
            new_bls12_381_fr!(
                "36439756010140137556111047750162544185710881404522379792044818039722752946048"
            ),
            new_bls12_381_fr!(
                "16497366583607480604161417644040292299204496829635795525393416854929276060989"
            ),
        ],
        [
            new_bls12_381_fr!(
                "7788624504122357216765350546787885309160020166693449889975992574536033007374"
            ),
            new_bls12_381_fr!(
                "16727395967350522643500778393489915391834352737211416857240725807058479128000"
            ),
        ],
        [
            new_bls12_381_fr!(
                "3134147137704626983201116226440762775442116005053282329971088789984415999550"
            ),
            new_bls12_381_fr!(
                "46525506418681456193255596516104416743523037046982280449529426136392814992763"
            ),
        ],
        [
            new_bls12_381_fr!(
                "50252287380741824818995733304361249016282047978221591906573165442023106203143"
            ),
            new_bls12_381_fr!(
                "46030886964045328670650579467522042981756109464584907077434772786649263902996"
            ),
        ],
        [
            new_bls12_381_fr!(
                "48434698978712278012409706205559577163572452744833134361195687109159129985373"
            ),
            new_bls12_381_fr!(
                "19216533213230709497947223526297848065365334472367022650183395435586190711770"
            ),
        ],
    ];
    const ROUND_KEYS_Y: [[BLSScalar; 2usize]; N_ANEMOI_ROUNDS] = [
        [
            new_bls12_381_fr!(
                "14981678621464625851270783002338847382197300714436467949315331057125308909900"
            ),
            new_bls12_381_fr!(
                "48720959343719104324739338388885839802998711550637402773896395605948383052052"
            ),
        ],
        [
            new_bls12_381_fr!(
                "28253420209785428420233456008091632509255652343634529984400816700490470131093"
            ),
            new_bls12_381_fr!(
                "6257781313532096835800460747082714697295034136932481743077166200794135826591"
            ),
        ],
        [
            new_bls12_381_fr!(
                "51511939407083344002778208487678590135577660247075600880835916725469990319313"
            ),
            new_bls12_381_fr!(
                "4386017178186728799761421274050927732938229436976005221436222062273391481632"
            ),
        ],
        [
            new_bls12_381_fr!(
                "46291121544435738125248657675097664742296276807186696922340332893747842754587"
            ),
            new_bls12_381_fr!(
                "13820180736478645172746469075181304604729976364812127548341524461074783412926"
            ),
        ],
        [
            new_bls12_381_fr!(
                "3650460179273129580093806058710273018999560093475503119057680216309578390988"
            ),
            new_bls12_381_fr!(
                "40385222771838099109662234020243831589690223478794847201235014486200724862134"
            ),
        ],
        [
            new_bls12_381_fr!(
                "45802223370746268123059159806400152299867771061127345631244786118574025749328"
            ),
            new_bls12_381_fr!(
                "50306980075778262214155693291132052551559962723436936231611301042966928400825"
            ),
        ],
        [
            new_bls12_381_fr!(
                "11798621276624967315721748990709309216351696098813162382053396097866233042733"
            ),
            new_bls12_381_fr!(
                "34806952212038537244506031612074847133207330427265785757809673463434908473570"
            ),
        ],
        [
            new_bls12_381_fr!(
                "42372918959432199162670834641599336326433006968669415662488070504036922966492"
            ),
            new_bls12_381_fr!(
                "22755759419530071315007011572076166983660942447634027701351681157370705921018"
            ),
        ],
        [
            new_bls12_381_fr!(
                "52181371244193189669553521955614617990714056725501643636576377752669773323445"
            ),
            new_bls12_381_fr!(
                "30334172084294870556875274308904688414158741457854908094300017436690480001547"
            ),
        ],
        [
            new_bls12_381_fr!(
                "23791984554824031672195249524658580601428376029501889159059009332107176394097"
            ),
            new_bls12_381_fr!(
                "19832360622723392584029764807971325641132953515557801717644226271356492507876"
            ),
        ],
        [
            new_bls12_381_fr!(
                "33342520831620303764059548442834699069640109058400548818586964467754352720368"
            ),
            new_bls12_381_fr!(
                "5828182614154296575131381170785760240834851189333374788484657124381010655319"
            ),
        ],
        [
            new_bls12_381_fr!(
                "16791548253207744974576845515705461794133799104808996134617754018912057476556"
            ),
            new_bls12_381_fr!(
                "23729797853490401568967730686618146850735129707152853256809050789424668284094"
            ),
        ],
        [
            new_bls12_381_fr!(
                "11087343419860825311828133337767238110556416596687749174422888171911517001265"
            ),
            new_bls12_381_fr!(
                "22848708497596347027267124890363029002241440143993561170521113640580467699956"
            ),
        ],
        [
            new_bls12_381_fr!(
                "11931207770538477937808955037363240956790374856666237106403111503668796872571"
            ),
            new_bls12_381_fr!(
                "51131682674615117766578358255722474622484771145670260043231096654077231782319"
            ),
        ],
    ];
    const PREPROCESSED_ROUND_KEYS_X: [[BLSScalar; 2usize]; N_ANEMOI_ROUNDS] = [
        [
            new_bls12_381_fr!(
                "35132796657602600463082375807523947538812231901617345651700352053179413136781"
            ),
            new_bls12_381_fr!(
                "34244909804696797914977531108300641954611059073636574396888394779248857231508"
            ),
        ],
        [
            new_bls12_381_fr!(
                "19518462785967057380702359780798543707306743933542504890948934755953669240340"
            ),
            new_bls12_381_fr!(
                "14343181970341684344746736539786336821708989609229782010678317217835345634496"
            ),
        ],
        [
            new_bls12_381_fr!(
                "1280182250808463064069739072639580198321005245360968642342534954946659095996"
            ),
            new_bls12_381_fr!(
                "5789351281680991775104723707018047610865812069264782640781902527576995602616"
            ),
        ],
        [
            new_bls12_381_fr!(
                "12917317245800232823312339376726682254165898162043336464896176463589902453936"
            ),
            new_bls12_381_fr!(
                "38099935623488601111574835192166596704204262896064643839548050355536965780428"
            ),
        ],
        [
            new_bls12_381_fr!(
                "9432499781760597646575150489221711739514045143113624977048861632023555983585"
            ),
            new_bls12_381_fr!(
                "21921324117271458287581191438874921625841930614652188670657950018447272905778"
            ),
        ],
        [
            new_bls12_381_fr!(
                "44749114108025139242896867457367565750148030721052027062885710492975420462868"
            ),
            new_bls12_381_fr!(
                "46670980961678385693911540867523569351549420764844623600953596259803056809033"
            ),
        ],
        [
            new_bls12_381_fr!(
                "44331654270897503518345862207666686543905076299424829376126068364806774577553"
            ),
            new_bls12_381_fr!(
                "39455042004050904326265629541960763985502481781452764451889409064256103825517"
            ),
        ],
        [
            new_bls12_381_fr!(
                "25397642390476179132850771805677049803684558688177252277298549570426056531738"
            ),
            new_bls12_381_fr!(
                "43420677778231529676038383613934919857626850821578780217791815740095224446957"
            ),
        ],
        [
            new_bls12_381_fr!(
                "7865686619281728270566973876298883777720675732146953462008093501962786726766"
            ),
            new_bls12_381_fr!(
                "49316425893787019572758871565432056487637659667855577267713966630976745513261"
            ),
        ],
        [
            new_bls12_381_fr!(
                "18296020121140903544848789423796877872201331641268182367221835345114867351880"
            ),
            new_bls12_381_fr!(
                "27551233044646746256116389254759412792175033676067843312587714357954056425696"
            ),
        ],
        [
            new_bls12_381_fr!(
                "17063744410512740051060154299389547293101620747735211896482626547105022844026"
            ),
            new_bls12_381_fr!(
                "28935898114531957970138963800983463391948502265386952340635825811790727331011"
            ),
        ],
        [
            new_bls12_381_fr!(
                "12357892136001399871270125352110251804520186600759749813432591912198594750073"
            ),
            new_bls12_381_fr!(
                "39040180517201885021635694488128160399749521902508892259893773577272107159054"
            ),
        ],
        [
            new_bls12_381_fr!(
                "6423101892721327565999789277789342150237144772997483127055941542079694804833"
            ),
            new_bls12_381_fr!(
                "43239080246748394656232336200964787450347543935784669573476707139890746072062"
            ),
        ],
        [
            new_bls12_381_fr!(
                "28628123434903238012291920722880496023062010740389765209578859196836509165225"
            ),
            new_bls12_381_fr!(
                "41017637540817801101955885117378545898192908982018087583407281952942417714634"
            ),
        ],
    ];
    const PREPROCESSED_ROUND_KEYS_Y: [[BLSScalar; 2usize]; N_ANEMOI_ROUNDS] = [
        [
            new_bls12_381_fr!(
                "15708940413097757154186986844111910752060195475863555301496544479594607502297"
            ),
            new_bls12_381_fr!(
                "37829026390719005581368619891862286465828012819684517413928271439190680200306"
            ),
        ],
        [
            new_bls12_381_fr!(
                "6903342433746195620173025275889411309314567236903072617208591530213385623265"
            ),
            new_bls12_381_fr!(
                "27525015962965320130966884226462943773955964117618716110980265374788055496716"
            ),
        ],
        [
            new_bls12_381_fr!(
                "52035199701473823743019958609755404845925046954613995458305940297908538445127"
            ),
            new_bls12_381_fr!(
                "47583216738549075249426776308188844155584955228275123873827837819969177541533"
            ),
        ],
        [
            new_bls12_381_fr!(
                "44297986458849046237780354818330905433258524837262076678300868840603339613203"
            ),
            new_bls12_381_fr!(
                "18673509972410630764318469548382268759181261392406521477593533036638926456331"
            ),
        ],
        [
            new_bls12_381_fr!(
                "11467534316692206668723143206125744312255318387854678094541989466226374199061"
            ),
            new_bls12_381_fr!(
                "33826945541392553612162604225303833501063539817885086225678896318911308507006"
            ),
        ],
        [
            new_bls12_381_fr!(
                "24310265776571972481166247917999461768474261684343458977492451733195230408699"
            ),
            new_bls12_381_fr!(
                "33568625636565051686786179408078630160665043929444283827144537246171891927779"
            ),
        ],
        [
            new_bls12_381_fr!(
                "28428602534529215507004327869167383258096587208663738081551098556714075990614"
            ),
            new_bls12_381_fr!(
                "43248321846338086816089596369580333585090156102528408260086023851266698754731"
            ),
        ],
        [
            new_bls12_381_fr!(
                "15074291737637250854933591409916388023116617456665681340222386028211868055561"
            ),
            new_bls12_381_fr!(
                "33307154578062898199188177423219187022105019432899665439849892473088661642312"
            ),
        ],
        [
            new_bls12_381_fr!(
                "44427103181085891818815229412695051550367249632673770038360401503855096442675"
            ),
            new_bls12_381_fr!(
                "19593466618348155529191951033226809843580925559714836668017703262307693866319"
            ),
        ],
        [
            new_bls12_381_fr!(
                "23682323551126973197951039689910185105130629930878147365234075420702925532448"
            ),
            new_bls12_381_fr!(
                "48757990470941753223670723473512271123475624873701802773279978032141187628683"
            ),
        ],
        [
            new_bls12_381_fr!(
                "49490973660315295768132576522730151754172788922144757473632529422975379494191"
            ),
            new_bls12_381_fr!(
                "29455606195294563428354178938133915876850116746931803233029785336070420016114"
            ),
        ],
        [
            new_bls12_381_fr!(
                "50596326293409912891414017070240332688250678770523969094981131067034542092773"
            ),
            new_bls12_381_fr!(
                "50440212499875258051596377966190446491577720041765595490789486724976598827139"
            ),
        ],
        [
            new_bls12_381_fr!(
                "1005731989545535408584183258075553125496198046375006436664977493081809572309"
            ),
            new_bls12_381_fr!(
                "11722479135598711363120255103632187133095359885370063485908844710194866725911"
            ),
        ],
        [
            new_bls12_381_fr!(
                "2985317488954564952594871357793879915003874190570385764910380138389787751001"
            ),
            new_bls12_381_fr!(
                "52044963406451142103920278068218248427182828663025960110959167907983501841348"
            ),
        ],
    ];
    const MDS_MATRIX: [[BLSScalar; 2usize]; 2usize] = [
        [new_bls12_381_fr!("1"), new_bls12_381_fr!("7")],
        [new_bls12_381_fr!("7"), new_bls12_381_fr!("50")],
    ];
    const USE_PHT: bool = true;
    fn get_alpha_inv() -> Vec<u64> {
        vec![
            3689348813023923405u64,
            2413663763415232921u64,
            16233882818423549954u64,
            3341406743785779740u64,
        ]
    }
}
